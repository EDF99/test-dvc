schema: '2.0'
stages:
  preprocess_data:
    cmd: python src/preprocess.py --config=params.yaml
    deps:
    - path: datasets/raw/chimi_text_dataset.csv
      hash: md5
      md5: 94aee0544032aa63f0b5a10613ba6ec7
      size: 124677
    - path: src/preprocess.py
      hash: md5
      md5: a96980a4f074c5f5c5abfe605f3a5abc
      size: 2183
    params:
      params.yaml:
        base:
          seed: 42
          base_model_path: models/base-spa-mt5
        data:
          raw_dataset: datasets/raw/chimi_text_dataset.csv
          preprocessed_dataset: datasets/preprocessed/preprocessed_chimi_text_dataset
          validation_and_test_size: 0.1
    outs:
    - path: datasets/preprocessed/preprocessed_chimi_text_dataset
      hash: md5
      md5: 33797bda27bf3fe480551cb1bdee1790.dir
      size: 460215
      nfiles: 10
  train_model:
    cmd: python src/train.py --config=params.yaml
    deps:
    - path: datasets/preprocessed/preprocessed_chimi_text_dataset
      hash: md5
      md5: 33797bda27bf3fe480551cb1bdee1790.dir
      size: 460215
      nfiles: 10
    - path: models/base-spa-mt5
      hash: md5
      md5: a2ca8ba1f6589e3fc0917596b4382e4c.dir
      size: 978096281
      nfiles: 6
    - path: src/train.py
      hash: md5
      md5: 1be0d4920642e7776f5d1855273a1c37
      size: 3302
    params:
      params.yaml:
        base:
          seed: 42
          base_model_path: models/base-spa-mt5
        data:
          raw_dataset: datasets/raw/chimi_text_dataset.csv
          preprocessed_dataset: datasets/preprocessed/preprocessed_chimi_text_dataset
          validation_and_test_size: 0.1
        train:
          epochs: 2
          batch_size: 8
          trained_model_path: models/chimi-text-model
          reports_path: reports/train
    outs:
    - path: models/chimi-text-model
      hash: md5
      md5: fc47bf62bb529d3e9c52429636c3df11.dir
      size: 978042801
      nfiles: 7
    - path: reports/train
      hash: md5
      md5: 3ff0b49ab0151ac7a7fef47802bc4dc5.dir
      size: 978047580
      nfiles: 32
  evaluate_model:
    cmd: python src/eval.py --config=params.yaml
    deps:
    - path: datasets/preprocessed/preprocessed_chimi_text_dataset
      hash: md5
      md5: 33797bda27bf3fe480551cb1bdee1790.dir
      size: 460215
      nfiles: 10
    - path: models/chimi-text-model
      hash: md5
      md5: fc47bf62bb529d3e9c52429636c3df11.dir
      size: 978042801
      nfiles: 7
    - path: src/eval.py
      hash: md5
      md5: 4835281ee24d45c450febaa410ee5252
      size: 1862
    params:
      params.yaml:
        base:
          seed: 42
          base_model_path: models/base-spa-mt5
        data:
          raw_dataset: datasets/raw/chimi_text_dataset.csv
          preprocessed_dataset: datasets/preprocessed/preprocessed_chimi_text_dataset
          validation_and_test_size: 0.1
        train:
          epochs: 2
          batch_size: 8
          trained_model_path: models/chimi-text-model
          reports_path: reports/train
    outs:
    - path: reports/eval/metrics.json
      hash: md5
      md5: 993a7c0b8b4489c75d04e41d36531915
      size: 411
